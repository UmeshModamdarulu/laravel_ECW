// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/php-mariadb
{
    "name": "Laravel Development Environment",
    "dockerComposeFile": "docker-compose.yml",
    "service": "app",
    "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",

    // Forward ports for Laravel, MariaDB, PhpMyAdmin, and MailHog
    "forwardPorts": [
        8080, // Laravel web server (Apache/PHP-FPM)
        3306, // MariaDB
        8000, // PhpMyAdmin UI
        8025  // MailHog UI
    ],

    // Features to add to the dev container.
    "features": {
        // PHP feature: Installs Composer, Xdebug, and common PHP tools.
        "ghcr.io/devcontainers/features/php:1": {
            "version": "8.2",
            "installComposer": true,
            "installXdebug": true
        },
        // Node.js feature: Installs Node.js and NPM for front-end development.
        "ghcr.io/devcontainers/features/node:1": {
            "version": "lts"
        },
        // Git LFS for handling large files in Git.
        "ghcr.io/devcontainers/features/git-lfs:1": {}
        // The mysql-client feature was here, but we removed it to fix the error.
    },

    // Use 'postCreateCommand' to run commands after the container is created.
    "postCreateCommand": "/bin/bash .devcontainer/post-create.sh",

    // Configure tool-specific properties for VS Code.
    "customizations": {
        "vscode": {
            "extensions": [
                "bmewburn.vscode-intelephense-client",
                "Laravel.laravel-blade-spacer",
                "onecentlin.laravel5-snippets",
                "MehediDracula.php-namespace-resolver",
                "ikappas.phpcs",
                "calebporzio.project-snippets",
                "esbenp.prettier-vscode",
                "dbaeumer.vscode-eslint",
                "formulahendry.auto-rename-tag",
                "CoenraadS.bracket-pair-colorizer-2"
            ],
            "settings": {
                "php.validate.executablePath": "/usr/bin/php",
                "files.associations": {
                    "*.blade.php": "html"
                },
                "editor.formatOnSave": true,
                "editor.defaultFormatter": "esbenp.prettier-vscode"
            }
        }
    },
    "remoteUser": "root"
}
